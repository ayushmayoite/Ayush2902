{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/ourwebsite_copy_2026-02-21/lib/db.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || \"https://erpweaiypimorcunaimz.supabase.co\";\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || \"sb_publishable_21J6H7rVe81Ray_WLUDgEA_WU9iTNsG\";\r\n\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,gFAAwC;AAC5D,MAAM,kBAAkB,sFAA6C;AAG9D,MAAM,WAAW,IAAA,gMAAY,EAAC,aAAa"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///E:/ourwebsite_copy_2026-02-21/app/api/tracking/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { supabase } from \"@/lib/db\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n    try {\r\n        const { userId, productId } = await req.json();\r\n\r\n        if (!userId || !productId) {\r\n            return NextResponse.json({ error: \"Missing parameters\" }, { status: 400 });\r\n        }\r\n\r\n        // Fetch current history\r\n        const { data, error } = await supabase\r\n            .from(\"user_history\")\r\n            .select(\"viewed_products\")\r\n            .eq(\"user_id\", userId)\r\n            .single();\r\n\r\n        if (error && error.code !== \"PGRST116\") {\r\n            console.error(\"Supabase fetch error:\", error);\r\n        }\r\n\r\n        let viewedProducts = data?.viewed_products || [];\r\n\r\n        // Add without duplicates or push newest\r\n        if (!viewedProducts.includes(productId)) {\r\n            viewedProducts = [...viewedProducts, productId].slice(-10); // Keep last 10\r\n\r\n            await supabase\r\n                .from(\"user_history\")\r\n                .upsert({ user_id: userId, viewed_products: viewedProducts, updated_at: new Date().toISOString() }, { onConflict: \"user_id\" });\r\n        }\r\n\r\n        return NextResponse.json({ success: true, viewedProducts });\r\n    } catch (err) {\r\n        console.error(\"Tracking API Error:\", err);\r\n        return NextResponse.json({ error: \"Tracking failed\" }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAgB;IACvC,IAAI;QACA,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,GAAG,MAAM,IAAI,IAAI;QAE5C,IAAI,CAAC,UAAU,CAAC,WAAW;YACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAqB,GAAG;gBAAE,QAAQ;YAAI;QAC5E;QAEA,wBAAwB;QACxB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,uHAAQ,CACjC,IAAI,CAAC,gBACL,MAAM,CAAC,mBACP,EAAE,CAAC,WAAW,QACd,MAAM;QAEX,IAAI,SAAS,MAAM,IAAI,KAAK,YAAY;YACpC,QAAQ,KAAK,CAAC,yBAAyB;QAC3C;QAEA,IAAI,iBAAiB,MAAM,mBAAmB,EAAE;QAEhD,wCAAwC;QACxC,IAAI,CAAC,eAAe,QAAQ,CAAC,YAAY;YACrC,iBAAiB;mBAAI;gBAAgB;aAAU,CAAC,KAAK,CAAC,CAAC,KAAK,eAAe;YAE3E,MAAM,uHAAQ,CACT,IAAI,CAAC,gBACL,MAAM,CAAC;gBAAE,SAAS;gBAAQ,iBAAiB;gBAAgB,YAAY,IAAI,OAAO,WAAW;YAAG,GAAG;gBAAE,YAAY;YAAU;QACpI;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM;QAAe;IAC7D,EAAE,OAAO,KAAK;QACV,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAkB,GAAG;YAAE,QAAQ;QAAI;IACzE;AACJ"}}]
}