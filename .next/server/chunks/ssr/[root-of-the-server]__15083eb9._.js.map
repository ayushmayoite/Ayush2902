{"version":3,"sources":["../../../../app/products/%5Bcategory%5D/%5Bslug%5D/ProductViewer.tsx/__nextjs-internal-proxy.mjs","../../../../app/products/%5Bcategory%5D/%5Bslug%5D/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const ProductViewer = registerClientReference(\n    function() { throw new Error(\"Attempted to call ProductViewer() from the server but ProductViewer is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/products/[category]/[slug]/ProductViewer.tsx\",\n    \"ProductViewer\",\n);\n","import { supabase } from \"@/lib/db\";\r\nimport { notFound } from \"next/navigation\";\r\nimport { ProductViewer } from \"./ProductViewer\";\r\nimport type { Metadata } from \"next\";\r\nimport { Suspense } from \"react\";\r\nimport type { Product, CompatProduct } from \"@/lib/getProducts\";\r\n\r\nconst BASE_URL = \"http://localhost:3000\";\r\n\r\nexport async function generateMetadata({\r\n  params,\r\n}: {\r\n  params: Promise<{ category: string; slug: string }>;\r\n}): Promise<Metadata> {\r\n  const { category: categoryId, slug } = await params;\r\n\r\n  const { data: product } = await supabase\r\n    .from(\"products\")\r\n    .select(\"*\")\r\n    .eq(\"slug\", slug)\r\n    .single();\r\n\r\n  if (!product) return {};\r\n\r\n  const title = `${product.name} | One and Only Furniture`;\r\n  const description =\r\n    product.description ||\r\n    `${product.name} â€” premium office furniture from One and Only Furniture.`;\r\n  const images = Array.isArray(product.images) ? product.images : [];\r\n  const image =\r\n    (images.length > 0 ? images[0] : null) ||\r\n    product.flagship_image ||\r\n    \"/images/fallback/category.webp\";\r\n  const url = `${BASE_URL}/products/${categoryId}/${slug}`;\r\n\r\n  return {\r\n    title,\r\n    description,\r\n    alternates: { canonical: url },\r\n    openGraph: {\r\n      title,\r\n      description,\r\n      url,\r\n      type: \"website\",\r\n      images: [{ url: image, width: 800, height: 800, alt: product.name }],\r\n    },\r\n    twitter: {\r\n      card: \"summary_large_image\",\r\n      title,\r\n      description,\r\n      images: [image],\r\n    },\r\n  };\r\n}\r\n\r\nfunction ProductLoadingSkeleton() {\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center\">\r\n      <div className=\"animate-pulse space-y-4 w-full max-w-4xl px-6\">\r\n        <div className=\"h-96 bg-neutral-100 rounded\" />\r\n        <div className=\"h-8 bg-neutral-100 rounded w-1/3\" />\r\n        <div className=\"h-4 bg-neutral-100 rounded w-2/3\" />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nasync function ProductContent({\r\n  categoryId,\r\n  slug,\r\n}: {\r\n  categoryId: string;\r\n  slug: string;\r\n}) {\r\n  const { data: rawProduct } = await supabase\r\n    .from(\"products\")\r\n    .select(\"*\")\r\n    .eq(\"slug\", slug)\r\n    .single();\r\n\r\n  if (!rawProduct) {\r\n    notFound();\r\n  }\r\n\r\n  const p = rawProduct as Product;\r\n\r\n  const compatProduct: CompatProduct = {\r\n    id: p.id,\r\n    name: p.name,\r\n    description: p.description || \"\",\r\n    flagshipImage: p.flagship_image || \"\",\r\n    sceneImages: [],\r\n    images: p.images || [],\r\n    variants: [],\r\n    detailedInfo: {\r\n      overview: \"\",\r\n      features: [],\r\n      dimensions: \"\",\r\n      materials: [],\r\n    },\r\n    metadata: p.metadata || {},\r\n  };\r\n\r\n  const url = `${BASE_URL}/products/${categoryId}/${p.slug}`;\r\n  const productJsonLd = {\r\n    \"@context\": \"https://schema.org\",\r\n    \"@type\": \"Product\",\r\n    name: p.name,\r\n    description: (rawProduct as any).alt_text || p.description,\r\n    image: p.images || [p.flagship_image],\r\n    url,\r\n    brand: { \"@type\": \"Brand\", name: \"One and Only Furniture\" },\r\n    offers: {\r\n      \"@type\": \"Offer\",\r\n      availability: \"https://schema.org/InStock\",\r\n      priceCurrency: \"INR\",\r\n      seller: { \"@type\": \"Organization\", name: \"One and Only Furniture\" },\r\n    },\r\n    category: p.category_id,\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <script\r\n        type=\"application/ld+json\"\r\n        dangerouslySetInnerHTML={{ __html: JSON.stringify(productJsonLd) }}\r\n      />\r\n      <ProductViewer\r\n        product={compatProduct}\r\n        seriesName={p.series_name}\r\n        categoryRoute={`/products/${p.category_id || categoryId}`}\r\n        categoryId={p.category_id || categoryId}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default async function ProductPage({\r\n  params,\r\n}: {\r\n  params: Promise<{ category: string; slug: string }>;\r\n}) {\r\n  const { category: categoryId, slug } = await params;\r\n\r\n  return (\r\n    <Suspense fallback={<ProductLoadingSkeleton />}>\r\n      <ProductContent categoryId={categoryId} slug={slug} />\r\n    </Suspense>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","ignoreList":[0]}